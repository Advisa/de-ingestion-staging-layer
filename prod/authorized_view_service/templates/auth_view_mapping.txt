lvs_integration_legacy|applicants_lvs_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.address, VAULT.uuid)) ELSE raw.address END AS address, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.last_name, VAULT.uuid)) ELSE raw.last_name END AS last_name, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.post_code, VAULT.uuid)) ELSE raw.post_code END AS post_code, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.first_name, VAULT.uuid)) ELSE raw.first_name END AS first_name, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.phone, VAULT.uuid)) ELSE raw.phone END AS phone, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.email, VAULT.uuid)) ELSE raw.email END AS email, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.ssn, VAULT.uuid)) ELSE raw.ssn END AS ssn, CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.city, VAULT.uuid)) ELSE raw.city END AS city, raw.* EXCEPT(address, last_name, post_code, first_name, phone, email, ssn, city) FROM `sambla-data-staging-compliance.lvs_integration_legacy.applicants_lvs_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON raw.ssn = VAULT.ssn 
lvs_integration_legacy|credit_remarks_lvs_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.ssn_id, VAULT.uuid)) ELSE raw.ssn_id END AS ssn_id, raw.* EXCEPT(ssn_id) FROM `sambla-data-staging-compliance.lvs_integration_legacy.credit_remarks_lvs_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON raw.ssn_id = VAULT.ssn 
rahalaitos_integration_legacy|rahalaitos_customer_raha_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, raw.ssn, VAULT.uuid)) ELSE raw.ssn END AS ssn, raw.* EXCEPT(ssn) FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_customer_raha_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON raw.ssn = VAULT.ssn 
