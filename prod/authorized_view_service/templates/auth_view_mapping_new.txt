lvs_integration_legacy|clients_lvs_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.gender AS STRING), VAULT.uuid)) ELSE CAST(raw.gender AS STRING) END AS gender,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.ssn AS STRING), VAULT.uuid)) ELSE CAST(raw.ssn AS STRING) END AS ssn,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.phone AS STRING), VAULT.uuid)) ELSE CAST(raw.phone AS STRING) END AS phone,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.dob AS STRING), VAULT.uuid)) ELSE CAST(raw.dob AS STRING) END AS dob,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.post_code AS STRING), VAULT.uuid)) ELSE CAST(raw.post_code AS STRING) END AS post_code,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.address AS STRING), VAULT.uuid)) ELSE CAST(raw.address AS STRING) END AS address,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.city AS STRING), VAULT.uuid)) ELSE CAST(raw.city AS STRING) END AS city,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.last_name AS STRING), VAULT.uuid)) ELSE CAST(raw.last_name AS STRING) END AS last_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.first_name AS STRING), VAULT.uuid)) ELSE CAST(raw.first_name AS STRING) END AS first_name, raw.* EXCEPT(gender, email, ssn, phone, dob, post_code, address, city, last_name, first_name) FROM `sambla-data-staging-compliance.lvs_integration_legacy.clients_lvs_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.ssn AS STRING) = VAULT.ssn 
lvs_integration_legacy|applicants_lvs_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.education AS STRING), VAULT.uuid)) ELSE CAST(raw.education AS STRING) END AS education,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.marital_status AS STRING), VAULT.uuid)) ELSE CAST(raw.marital_status AS STRING) END AS marital_status,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.bank_bic AS STRING), VAULT.uuid)) ELSE CAST(raw.bank_bic AS STRING) END AS bank_bic,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.citizenship AS STRING), VAULT.uuid)) ELSE CAST(raw.citizenship AS STRING) END AS citizenship,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.dob AS STRING), VAULT.uuid)) ELSE CAST(raw.dob AS STRING) END AS dob,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.gender AS STRING), VAULT.uuid)) ELSE CAST(raw.gender AS STRING) END AS gender,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.address AS STRING), VAULT.uuid)) ELSE CAST(raw.address AS STRING) END AS address,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.bank_iban AS STRING), VAULT.uuid)) ELSE CAST(raw.bank_iban AS STRING) END AS bank_iban,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.last_name AS STRING), VAULT.uuid)) ELSE CAST(raw.last_name AS STRING) END AS last_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.post_code AS STRING), VAULT.uuid)) ELSE CAST(raw.post_code AS STRING) END AS post_code,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.first_name AS STRING), VAULT.uuid)) ELSE CAST(raw.first_name AS STRING) END AS first_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.phone AS STRING), VAULT.uuid)) ELSE CAST(raw.phone AS STRING) END AS phone,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.ssn AS STRING), VAULT.uuid)) ELSE CAST(raw.ssn AS STRING) END AS ssn,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.city AS STRING), VAULT.uuid)) ELSE CAST(raw.city AS STRING) END AS city, raw.* EXCEPT(education, marital_status, bank_bic, citizenship, dob, gender, address, bank_iban, last_name, post_code, first_name, phone, email, ssn, city) FROM `sambla-data-staging-compliance.lvs_integration_legacy.applicants_lvs_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.ssn AS STRING) = VAULT.ssn 
lvs_integration_legacy|providers_lvs_r|SELECT * FROM `sambla-data-staging-compliance.lvs_integration_legacy.providers_lvs_r
lvs_integration_legacy|credit_remarks_lvs_r|SELECT * FROM `sambla-data-staging-compliance.lvs_integration_legacy.credit_remarks_lvs_r
maxwell_integration_legacy|event_data_sgmw_r|SELECT * FROM `sambla-data-staging-compliance.maxwell_integration_legacy.event_data_sgmw_r
maxwell_integration_legacy|credit_reports_xml_extract|SELECT * FROM `sambla-data-staging-compliance.maxwell_integration_legacy.credit_reports_xml_extract
maxwell_integration_legacy|raw_data_s3_new|SELECT * FROM `sambla-data-staging-compliance.maxwell_integration_legacy.raw_data_s3_new
maxwell_integration_legacy|raw_data_snowflake_export_persisted|SELECT * FROM `sambla-data-staging-compliance.maxwell_integration_legacy.raw_data_snowflake_export_persisted
rahalaitos_integration_legacy|insurance_agreement_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_agreement_type_raha_r
rahalaitos_integration_legacy|insurance_insurance_details_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_details_raha_r
rahalaitos_integration_legacy|insurance_insurance_product_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_product_raha_r
rahalaitos_integration_legacy|insurance_history_type_priority_level_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_type_priority_level_raha_r
rahalaitos_integration_legacy|marketing_applicant_business_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_applicant_business_raha_r
rahalaitos_integration_legacy|marketing_applicant_raha_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sotu AS STRING), VAULT.uuid)) ELSE CAST(raw.sotu AS STRING) END AS sotu,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.etunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.etunimi AS STRING) END AS etunimi,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sukunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.sukunimi AS STRING) END AS sukunimi,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.osoite AS STRING), VAULT.uuid)) ELSE CAST(raw.osoite AS STRING) END AS osoite,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.postinro AS STRING), VAULT.uuid)) ELSE CAST(raw.postinro AS STRING) END AS postinro,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.birthday AS STRING), VAULT.uuid)) ELSE CAST(raw.birthday AS STRING) END AS birthday,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.gender AS STRING), VAULT.uuid)) ELSE CAST(raw.gender AS STRING) END AS gender,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.tili AS STRING), VAULT.uuid)) ELSE CAST(raw.tili AS STRING) END AS tili,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.birthdate AS STRING), VAULT.uuid)) ELSE CAST(raw.birthdate AS STRING) END AS birthdate, raw.* EXCEPT(sotu, etunimi, sukunimi, email, osoite, postinro, birthday, gender, tili, birthdate) FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_applicant_raha_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.sotu AS STRING) = VAULT.ssn 
rahalaitos_integration_legacy|insurance_log_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_log_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_brands_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_brands_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_tag_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_tag_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_bankinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_bankinfo_raha_r
rahalaitos_integration_legacy|rahalaitos_citizenShip_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_citizenShip_raha_r
rahalaitos_integration_legacy|rahalaitos_company_types_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_company_types_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_decision_history_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_decision_history_raha_r
rahalaitos_integration_legacy|crm_user_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.crm_user_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_companyinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_companyinfo_raha_r
rahalaitos_integration_legacy|rahalaitos_application_ispep_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_application_ispep_raha_r
rahalaitos_integration_legacy|insurance_person_information_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_person_information_raha_r
rahalaitos_integration_legacy|rahalaitos_customer_raha_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.ssn AS STRING), VAULT.uuid)) ELSE CAST(raw.ssn AS STRING) END AS ssn,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.birthday AS STRING), VAULT.uuid)) ELSE CAST(raw.birthday AS STRING) END AS birthday,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.gender AS STRING), VAULT.uuid)) ELSE CAST(raw.gender AS STRING) END AS gender, raw.* EXCEPT(ssn, birthday, gender) FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_customer_raha_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.ssn AS STRING) = VAULT.ssn 
rahalaitos_integration_legacy|rahalaitos_incomplete_applications_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_incomplete_applications_r
rahalaitos_integration_legacy|rahalaitos_all_customers_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_all_customers_r
rahalaitos_integration_legacy|insurance_insurance_language_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_language_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_yv_candidateinfo_raha_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_etunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_etunimi AS STRING) END AS yv_etunimi,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_sukunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_sukunimi AS STRING) END AS yv_sukunimi,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_osoite AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_osoite AS STRING) END AS yv_osoite,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_postinro AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_postinro AS STRING) END AS yv_postinro,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_sotu AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_sotu AS STRING) END AS yv_sotu,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_siviilisaaty AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_siviilisaaty AS STRING) END AS yv_siviilisaaty,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_ytunnus AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_ytunnus AS STRING) END AS yv_ytunnus,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_email AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_email AS STRING) END AS yv_email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_koulutus AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_koulutus AS STRING) END AS yv_koulutus, raw.* EXCEPT(yv_etunimi, yv_sukunimi, yv_osoite, yv_postinro, yv_sotu, yv_siviilisaaty, yv_ytunnus, yv_email, yv_koulutus) FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_yv_candidateinfo_raha_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.yv_sotu AS STRING) = VAULT.ssn 
rahalaitos_integration_legacy|insurance_insurance_status_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_status_raha_r
rahalaitos_integration_legacy|insurance_history_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_type_raha_r
rahalaitos_integration_legacy|rahalaitos_marketing_email_temp_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_marketing_email_temp_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_contactinfo_raha_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.etunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.etunimi AS STRING) END AS etunimi,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sukunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.sukunimi AS STRING) END AS sukunimi,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.osoite AS STRING), VAULT.uuid)) ELSE CAST(raw.osoite AS STRING) END AS osoite,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.postinro AS STRING), VAULT.uuid)) ELSE CAST(raw.postinro AS STRING) END AS postinro,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sotu AS STRING), VAULT.uuid)) ELSE CAST(raw.sotu AS STRING) END AS sotu, raw.* EXCEPT(etunimi, sukunimi, osoite, postinro, email, sotu) FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_contactinfo_raha_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.sotu AS STRING) = VAULT.ssn 
rahalaitos_integration_legacy|insurance_insurance_personal_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_personal_raha_r
rahalaitos_integration_legacy|marketing_external_marketing_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_external_marketing_raha_r
rahalaitos_integration_legacy|rahalaitos_laina_decision_data_types_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_decision_data_types_raha_r
rahalaitos_integration_legacy|rahalaitos_loan_applicant_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_applicant_type_raha_r
rahalaitos_integration_legacy|rahalaitos_loan_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_type_raha_r
rahalaitos_integration_legacy|rahalaitos_marketing_sms_temp_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_marketing_sms_temp_raha_r
salus_integration_legacy|invitations_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.invitations_salus_r
salus_integration_legacy|accounts_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.accounts_salus_r
salus_integration_legacy|commision-rules_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.commision-rules_salus_r
salus_integration_legacy|applicants_salus_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.birthdate AS STRING), VAULT.uuid)) ELSE CAST(raw.birthdate AS STRING) END AS birthdate,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.firstname AS STRING), VAULT.uuid)) ELSE CAST(raw.firstname AS STRING) END AS firstname,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.lastname AS STRING), VAULT.uuid)) ELSE CAST(raw.lastname AS STRING) END AS lastname,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.gender AS STRING), VAULT.uuid)) ELSE CAST(raw.gender AS STRING) END AS gender,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.maritalstatus AS STRING), VAULT.uuid)) ELSE CAST(raw.maritalstatus AS STRING) END AS maritalstatus,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.nationality AS STRING), VAULT.uuid)) ELSE CAST(raw.nationality AS STRING) END AS nationality,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.education AS STRING), VAULT.uuid)) ELSE CAST(raw.education AS STRING) END AS education,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.phone AS STRING), VAULT.uuid)) ELSE CAST(raw.phone AS STRING) END AS phone,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.ssn AS STRING), VAULT.uuid)) ELSE CAST(raw.ssn AS STRING) END AS ssn,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.address AS STRING), VAULT.uuid)) ELSE CAST(raw.address AS STRING) END AS address,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.city AS STRING), VAULT.uuid)) ELSE CAST(raw.city AS STRING) END AS city,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.zip AS STRING), VAULT.uuid)) ELSE CAST(raw.zip AS STRING) END AS zip, raw.* EXCEPT(birthdate, firstname, lastname, gender, maritalstatus, nationality, education, email, phone, ssn, address, city, zip) FROM `sambla-data-staging-compliance.salus_integration_legacy.applicants_salus_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.ssn AS STRING) = VAULT.ssn 
salus_integration_legacy|applicant-loans_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.applicant-loans_salus_r
salus_integration_legacy|applicant-jobs_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.applicant-jobs_salus_r
salus_integration_legacy|bids_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.bids_salus_r
salus_integration_legacy|applications_salus_r|SELECT * FROM `sambla-data-staging-compliance.salus_integration_legacy.applications_salus_r
sambla_legacy_integration_legacy|applications_gcs_streaming|SELECT * FROM `sambla-data-staging-compliance.sambla_legacy_integration_legacy.applications_gcs_streaming
sambla_legacy_integration_legacy|bankloaninvitations_gcs_streaming|SELECT * FROM `sambla-data-staging-compliance.sambla_legacy_integration_legacy.bankloaninvitations_gcs_streaming
sambla_legacy_integration_legacy|banks_gcs_streaming|SELECT * FROM `sambla-data-staging-compliance.sambla_legacy_integration_legacy.banks_gcs_streaming
sambla_legacy_integration_legacy|users_gcs_streaming|SELECT * FROM `sambla-data-staging-compliance.sambla_legacy_integration_legacy.users_gcs_streaming
advisa_history_integration_legacy|applications_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.applications_adhis_r
advisa_history_integration_legacy|applicants_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.applicants_adhis_r
advisa_history_integration_legacy|insurance_repayments_mutual_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_repayments_mutual_adhis_r
advisa_history_integration_legacy|insurance_partners_mdn_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_partners_mdn_adhis_r
advisa_history_integration_legacy|subscription_month_invoice_items_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.subscription_month_invoice_items_adhis_r
advisa_history_integration_legacy|insurance_invoice_lines_mutual_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_invoice_lines_mutual_adhis_r
advisa_history_integration_legacy|insurance_payment_insurances_mutual_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_payment_insurances_mutual_adhis_r
advisa_history_integration_legacy|invoices_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.invoices_adhis_r
advisa_history_integration_legacy|insurance_insurance_invoices_mutual_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_insurance_invoices_mutual_adhis_r
advisa_history_integration_legacy|insurance_invoice_items_mutual_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_invoice_items_mutual_adhis_r
advisa_history_integration_legacy|bids_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.bids_adhis_r
advisa_history_integration_legacy|people_adhis_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.contact_id AS STRING), VAULT.uuid)) ELSE CAST(raw.contact_id AS STRING) END AS contact_id,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.national_id AS STRING), VAULT.uuid)) ELSE CAST(raw.national_id AS STRING) END AS national_id,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.national_id_sensitive AS STRING), VAULT.uuid)) ELSE CAST(raw.national_id_sensitive AS STRING) END AS national_id_sensitive, raw.* EXCEPT(contact_id, national_id, national_id_sensitive) FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.people_adhis_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.national_id_sensitivenational_id_sensitivenational_id_sensitive AS STRING) = VAULT.ssn 
advisa_history_integration_legacy|creditors_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.creditors_adhis_r
advisa_history_integration_legacy|insurance_customers_mdn_adhis_r|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_organisation_name AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_organisation_name AS STRING) END AS customer_organisation_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_organisation_number AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_organisation_number AS STRING) END AS customer_organisation_number,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_first_name AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_first_name AS STRING) END AS customer_first_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_last_name AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_last_name AS STRING) END AS customer_last_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_address AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_address AS STRING) END AS customer_address,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_address2 AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_address2 AS STRING) END AS customer_address2,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_postal_code AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_postal_code AS STRING) END AS customer_postal_code,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_city AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_city AS STRING) END AS customer_city,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_state AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_state AS STRING) END AS customer_state,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_country_code AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_country_code AS STRING) END AS customer_country_code,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_country_name AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_country_name AS STRING) END AS customer_country_name,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_ssn AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_ssn AS STRING) END AS customer_ssn,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_phone AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_phone AS STRING) END AS customer_phone,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_email AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_email AS STRING) END AS customer_email,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_passport_number AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_passport_number AS STRING) END AS customer_passport_number,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_passport_issuance_country_code AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_passport_issuance_country_code AS STRING) END AS customer_passport_issuance_country_code,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.customer_passport_issuance_country_name AS STRING), VAULT.uuid)) ELSE CAST(raw.customer_passport_issuance_country_name AS STRING) END AS customer_passport_issuance_country_name, raw.* EXCEPT(customer_organisation_name, customer_organisation_number, customer_first_name, customer_last_name, customer_address, customer_address2, customer_postal_code, customer_city, customer_state, customer_country_code, customer_country_name, customer_ssn, customer_phone, customer_email, customer_passport_number, customer_passport_issuance_country_code, customer_passport_issuance_country_name) FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_customers_mdn_adhis_r` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.customer_ssn AS STRING) = VAULT.ssn 
advisa_history_integration_legacy|insurance_users_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_users_adhis_r
advisa_history_integration_legacy|archived_ssn|SELECT CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.contact_id AS STRING), VAULT.uuid)) ELSE CAST(raw.contact_id AS STRING) END AS contact_id,CASE WHEN VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.national_id AS STRING), VAULT.uuid)) ELSE CAST(raw.national_id AS STRING) END AS national_id, raw.* EXCEPT(contact_id, national_id) FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.archived_ssn` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault` VAULT ON CAST(raw.national_id AS STRING) = VAULT.ssn 
advisa_history_integration_legacy|cookies_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.cookies_adhis_r
advisa_history_integration_legacy|insurance_partners_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_partners_adhis_r
advisa_history_integration_legacy|insurance_payments_mutual_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_payments_mutual_adhis_r
advisa_history_integration_legacy|insurance_transactions_mdn_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_transactions_mdn_adhis_r
advisa_history_integration_legacy|credit_reports_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.credit_reports_adhis_r
advisa_history_integration_legacy|insurance_policies_mdn_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_policies_mdn_adhis_r
advisa_history_integration_legacy|subscriptions_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.subscriptions_adhis_r
advisa_history_integration_legacy|insurance_users_mdn_adhis_r|SELECT * FROM `sambla-data-staging-compliance.advisa_history_integration_legacy.insurance_users_mdn_adhis_r
