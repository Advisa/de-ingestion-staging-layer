rahalaitos_integration_legacy|marketing_marketing_ban_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_marketing_ban_raha_r`
rahalaitos_integration_legacy|insurance_agreement_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_agreement_type_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_decision_data_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_decision_data_raha_r`
rahalaitos_integration_legacy|insurance_insurance_details_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_details_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_bing_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_bing_raha_r`
rahalaitos_integration_legacy|insurance_insurance_product_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_product_raha_r`
rahalaitos_integration_legacy|insurance_history_type_priority_level_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_type_priority_level_raha_r`
rahalaitos_integration_legacy|insurance_insurance_response_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_response_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_whitelabel_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_whitelabel_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_bing_sent_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_bing_sent_raha_r`
rahalaitos_integration_legacy|marketing_applicant_business_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_applicant_business_raha_r`
rahalaitos_integration_legacy|marketing_applicant_raha_r|WITH data_with_ssn_rules AS (SELECT *, LEFT(REGEXP_REPLACE(UPPER(CAST(raw.sotu AS STRING)), "[^0-9-+A-Z]", ""), 11) AS ssn_clean FROM`sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_applicant_raha_r` raw) SELECT CASE WHEN raw.sotu IS NOT NULL  AND raw.sotu <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sotu AS STRING), VAULT.uuid)) ELSE CAST(raw.sotu AS STRING) END AS sotu, CASE WHEN raw.etunimi IS NOT NULL  AND raw.etunimi <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.etunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.etunimi AS STRING) END AS etunimi, CASE WHEN raw.sukunimi IS NOT NULL  AND raw.sukunimi <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sukunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.sukunimi AS STRING) END AS sukunimi, CASE WHEN raw.puhelin IS NOT NULL  AND raw.puhelin <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.puhelin AS STRING), VAULT.uuid)) ELSE CAST(raw.puhelin AS STRING) END AS puhelin, CASE WHEN raw.email IS NOT NULL  AND raw.email <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email, CASE WHEN raw.osoite IS NOT NULL  AND raw.osoite <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.osoite AS STRING), VAULT.uuid)) ELSE CAST(raw.osoite AS STRING) END AS osoite, CASE WHEN raw.kaupunki IS NOT NULL  AND raw.kaupunki <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.kaupunki AS STRING), VAULT.uuid)) ELSE CAST(raw.kaupunki AS STRING) END AS kaupunki, CASE WHEN raw.postinro IS NOT NULL  AND raw.postinro <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.postinro AS STRING), VAULT.uuid)) ELSE CAST(raw.postinro AS STRING) END AS postinro, CASE WHEN raw.tili IS NOT NULL  AND raw.tili <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.tili AS STRING), VAULT.uuid)) ELSE CAST(raw.tili AS STRING) END AS tili, raw.* EXCEPT(sotu, etunimi, sukunimi, puhelin, email, osoite, kaupunki, postinro, tili) FROM `data_with_ssn_rules` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault_rudolf` VAULT ON CAST(raw.ssn_clean AS STRING) = VAULT.ssn
rahalaitos_integration_legacy|rahalaitos_laina_yv_candidate_loans_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_yv_candidate_loans_raha_r`
rahalaitos_integration_legacy|rahalaitos_company_external_id_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_company_external_id_raha_r`
rahalaitos_integration_legacy|insurance_person_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_person_raha_r`
rahalaitos_integration_legacy|insurance_insurance_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_raha_r`
rahalaitos_integration_legacy|insurance_log_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_log_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_kieltolista_sms_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_kieltolista_sms_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_tags_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_tags_raha_r`
rahalaitos_integration_legacy|insurance_person_identify_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_person_identify_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_brands_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_brands_raha_r`
rahalaitos_integration_legacy|crm_user_roles_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.crm_user_roles_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_tag_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_tag_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_outpayment_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_outpayment_raha_r`
rahalaitos_integration_legacy|insurance_history_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_bankinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_bankinfo_raha_r`
rahalaitos_integration_legacy|marketing_marketing_outpayment_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_marketing_outpayment_raha_r`
rahalaitos_integration_legacy|rahalaitos_company_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_company_raha_r`
rahalaitos_integration_legacy|rahalaitos_citizenShip_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_citizenShip_raha_r`
rahalaitos_integration_legacy|rahalaitos_company_types_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_company_types_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_decision_history_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_decision_history_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_rahoistuspaatos_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_rahoistuspaatos_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaigninfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaigninfo_raha_r`
rahalaitos_integration_legacy|rahalaitos_loan_refinance_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_refinance_raha_r`
rahalaitos_integration_legacy|crm_user_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.crm_user_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_send_queue_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_send_queue_raha_r`
rahalaitos_integration_legacy|insurance_agreement_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_agreement_raha_r`
rahalaitos_integration_legacy|rahalaitos_customer_preferences_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_customer_preferences_raha_r`
rahalaitos_integration_legacy|rahalaitos_application_page_origin_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_application_page_origin_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_companyinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_companyinfo_raha_r`
rahalaitos_integration_legacy|rahalaitos_application_ispep_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_application_ispep_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_groups_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_groups_raha_r`
rahalaitos_integration_legacy|insurance_postal_code_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_postal_code_raha_r`
rahalaitos_integration_legacy|insurance_person_information_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_person_information_raha_r`
rahalaitos_integration_legacy|rahalaitos_loan_application_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_application_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_gallup_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_gallup_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_facebook_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_facebook_raha_r`
rahalaitos_integration_legacy|rahalaitos_loan_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_workinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_workinfo_raha_r`
rahalaitos_integration_legacy|insurance_history_details_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_details_raha_r`
rahalaitos_integration_legacy|rahalaitos_customer_raha_r|WITH data_with_ssn_rules AS (SELECT *, LEFT(REGEXP_REPLACE(UPPER(CAST(raw.ssn AS STRING)), "[^0-9-+A-Z]", ""), 11) AS ssn_clean FROM`sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_customer_raha_r` raw) SELECT CASE WHEN raw.ssn IS NOT NULL  AND raw.ssn <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.ssn AS STRING), VAULT.uuid)) ELSE CAST(raw.ssn AS STRING) END AS ssn, raw.* EXCEPT(ssn) FROM `data_with_ssn_rules` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault_rudolf` VAULT ON CAST(raw.ssn_clean AS STRING) = VAULT.ssn
rahalaitos_integration_legacy|rahalaitos_incomplete_applications_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_incomplete_applications_r`
rahalaitos_integration_legacy|rahalaitos_all_customers_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_all_customers_r`
rahalaitos_integration_legacy|insurance_insurance_language_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_language_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_yv_candidateinfo_raha_r|WITH data_with_ssn_rules AS (SELECT *, LEFT(REGEXP_REPLACE(UPPER(CAST(raw.yv_sotu AS STRING)), "[^0-9-+A-Z]", ""), 11) AS ssn_clean FROM`sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_yv_candidateinfo_raha_r` raw) SELECT CASE WHEN raw.yv_etunimi IS NOT NULL  AND raw.yv_etunimi <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_etunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_etunimi AS STRING) END AS yv_etunimi, CASE WHEN raw.yv_sukunimi IS NOT NULL  AND raw.yv_sukunimi <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_sukunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_sukunimi AS STRING) END AS yv_sukunimi, CASE WHEN raw.yv_osoite IS NOT NULL  AND raw.yv_osoite <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_osoite AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_osoite AS STRING) END AS yv_osoite, CASE WHEN raw.yv_postinro IS NOT NULL  AND raw.yv_postinro <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_postinro AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_postinro AS STRING) END AS yv_postinro, CASE WHEN raw.yv_kaupunki IS NOT NULL  AND raw.yv_kaupunki <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_kaupunki AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_kaupunki AS STRING) END AS yv_kaupunki, CASE WHEN raw.yv_puhelin IS NOT NULL  AND raw.yv_puhelin <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_puhelin AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_puhelin AS STRING) END AS yv_puhelin, CASE WHEN raw.yv_tyopuhelin IS NOT NULL  AND raw.yv_tyopuhelin <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_tyopuhelin AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_tyopuhelin AS STRING) END AS yv_tyopuhelin, CASE WHEN raw.yv_asuu IS NOT NULL  AND raw.yv_asuu <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_asuu AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_asuu AS STRING) END AS yv_asuu, CASE WHEN raw.yv_sotu IS NOT NULL  AND raw.yv_sotu <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_sotu AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_sotu AS STRING) END AS yv_sotu, CASE WHEN raw.yv_tyonantaja IS NOT NULL  AND raw.yv_tyonantaja <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_tyonantaja AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_tyonantaja AS STRING) END AS yv_tyonantaja, CASE WHEN raw.yv_tyonantajapuh IS NOT NULL  AND raw.yv_tyonantajapuh <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_tyonantajapuh AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_tyonantajapuh AS STRING) END AS yv_tyonantajapuh, CASE WHEN raw.yv_ytunnus IS NOT NULL  AND raw.yv_ytunnus <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_ytunnus AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_ytunnus AS STRING) END AS yv_ytunnus, CASE WHEN raw.yv_email IS NOT NULL  AND raw.yv_email <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.yv_email AS STRING), VAULT.uuid)) ELSE CAST(raw.yv_email AS STRING) END AS yv_email, raw.* EXCEPT(yv_etunimi, yv_sukunimi, yv_osoite, yv_postinro, yv_kaupunki, yv_puhelin, yv_tyopuhelin, yv_asuu, yv_sotu, yv_tyonantaja, yv_tyonantajapuh, yv_ytunnus, yv_email) FROM `data_with_ssn_rules` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault_rudolf` VAULT ON CAST(raw.ssn_clean AS STRING) = VAULT.ssn
rahalaitos_integration_legacy|insurance_insurance_status_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_status_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_orders_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_orders_raha_r`
rahalaitos_integration_legacy|insurance_insurance_application_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_application_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_affiliate_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_affiliate_raha_r`
rahalaitos_integration_legacy|rahalaitos_loan_details_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_details_raha_r`
rahalaitos_integration_legacy|rahalaitos_company_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_company_type_raha_r`
rahalaitos_integration_legacy|insurance_history_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_type_raha_r`
rahalaitos_integration_legacy|rahalaitos_marketing_email_temp_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_marketing_email_temp_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_login_persons_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_login_persons_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_contactinfo_raha_r|WITH data_with_ssn_rules AS (SELECT *, LEFT(REGEXP_REPLACE(UPPER(CAST(raw.sotu AS STRING)), "[^0-9-+A-Z]", ""), 11) AS ssn_clean FROM`sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_contactinfo_raha_r` raw) SELECT CASE WHEN raw.etunimi IS NOT NULL  AND raw.etunimi <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.etunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.etunimi AS STRING) END AS etunimi, CASE WHEN raw.sukunimi IS NOT NULL  AND raw.sukunimi <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sukunimi AS STRING), VAULT.uuid)) ELSE CAST(raw.sukunimi AS STRING) END AS sukunimi, CASE WHEN raw.osoite IS NOT NULL  AND raw.osoite <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.osoite AS STRING), VAULT.uuid)) ELSE CAST(raw.osoite AS STRING) END AS osoite, CASE WHEN raw.postinro IS NOT NULL  AND raw.postinro <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.postinro AS STRING), VAULT.uuid)) ELSE CAST(raw.postinro AS STRING) END AS postinro, CASE WHEN raw.kaupunki IS NOT NULL  AND raw.kaupunki <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.kaupunki AS STRING), VAULT.uuid)) ELSE CAST(raw.kaupunki AS STRING) END AS kaupunki, CASE WHEN raw.puhelin IS NOT NULL  AND raw.puhelin <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.puhelin AS STRING), VAULT.uuid)) ELSE CAST(raw.puhelin AS STRING) END AS puhelin, CASE WHEN raw.tyopuhelin IS NOT NULL  AND raw.tyopuhelin <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.tyopuhelin AS STRING), VAULT.uuid)) ELSE CAST(raw.tyopuhelin AS STRING) END AS tyopuhelin, CASE WHEN raw.email IS NOT NULL  AND raw.email <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.email AS STRING), VAULT.uuid)) ELSE CAST(raw.email AS STRING) END AS email, CASE WHEN raw.sotu IS NOT NULL  AND raw.sotu <> '' AND VAULT.uuid IS NOT NULL THEN TO_HEX(SAFE.DETERMINISTIC_ENCRYPT(VAULT.aead_key, CAST(raw.sotu AS STRING), VAULT.uuid)) ELSE CAST(raw.sotu AS STRING) END AS sotu, raw.* EXCEPT(etunimi, sukunimi, osoite, postinro, kaupunki, puhelin, tyopuhelin, email, sotu) FROM `data_with_ssn_rules` raw LEFT JOIN `sambla-group-compliance-db.compilance_database.gdpr_vault_rudolf` VAULT ON CAST(raw.ssn_clean AS STRING) = VAULT.ssn
rahalaitos_integration_legacy|insurance_insurance_personal_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_personal_raha_r`
rahalaitos_integration_legacy|insurance_person_agent_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_person_agent_raha_r`
rahalaitos_integration_legacy|insurance_history_user_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_user_raha_r`
rahalaitos_integration_legacy|crm_role_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.crm_role_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_google_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_google_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_loanorg_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_loanorg_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_gallup_fields_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_gallup_fields_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_adservicemedia_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_adservicemedia_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_businessinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_businessinfo_raha_r`
rahalaitos_integration_legacy|insurance_insurance_gender_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_gender_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_defaults_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_defaults_raha_r`
rahalaitos_integration_legacy|rahalaitos_campaign_groups_name_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_campaign_groups_name_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_generalinfo_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_generalinfo_raha_r`
rahalaitos_integration_legacy|marketing_external_marketing_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.marketing_external_marketing_raha_r`
rahalaitos_integration_legacy|insurance_insurance_sent_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_insurance_sent_raha_r`
rahalaitos_integration_legacy|rahalaitos_laina_decision_data_types_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_laina_decision_data_types_raha_r`
rahalaitos_integration_legacy|rahalaitos_loan_applicant_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_applicant_type_raha_r`
rahalaitos_integration_legacy|rahalaitos_loan_type_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_loan_type_raha_r`
rahalaitos_integration_legacy|rahalaitos_customer_counter_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_customer_counter_raha_r`
rahalaitos_integration_legacy|rahalaitos_marketing_sms_temp_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.rahalaitos_marketing_sms_temp_raha_r`
rahalaitos_integration_legacy|insurance_history_username_raha_r|SELECT * FROM `sambla-data-staging-compliance.rahalaitos_integration_legacy.insurance_history_username_raha_r`
